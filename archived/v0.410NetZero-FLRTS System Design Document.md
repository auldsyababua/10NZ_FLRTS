# # 10NetZero-FLRTS: System Design Document 

# 10NetZero-FLRTS: System Design Document

****Version:**** 1.1 (Updated Section 3.1)
****Date:**** May 8, 2025

## 1. Introduction

### 1.1. Purpose of the Document
This document outlines the design specifications for the 10NetZero-FLRTS (Field Reports, Lists, Reminders, Tasks, and Subtasks) system. It details the system architecture, data model, user interaction flows, third-party integrations, and core functionalities. This document serves as a foundational guide for the development and implementation of the MVP (Minimum Viable Product) and provides a roadmap for future enhancements.

### 1.2. System Overview (10NetZero-FLRTS)
The 10NetZero-FLRTS system is designed to be a comprehensive platform for managing operational items such as field reports, lists, reminders, and tasks. It aims to streamline workflows for users, particularly those in field operations, by leveraging natural language processing, a robust data backend, and seamless integration with tools like Telegram and Todoist. The system will feature a Telegram bot and MiniApp as the primary user interfaces, supported by a Flask backend, Airtable databases, and AI capabilities for parsing and specialized knowledge retrieval. This system integrates and expands upon concepts from the user's "10NetZero Integrated Platform Design (TgBot + SiteGPT)" document.

### 1.3. Core Goals
* ****Centralized Data Management:**** Establish a single source of truth for core business entities and FLRTS items.
* ****Intuitive User Experience:**** Prioritize natural language input and conversational interfaces for ease of use, especially on mobile devices.
* ****Efficient Workflow Automation:**** Streamline the creation, assignment, and tracking of FLRTS items.
* ****Seamless Integration:**** Leverage existing tools like Todoist for their strengths in task management and reminders, and integrate specialized AI (SiteGPT) for document-based knowledge work.
* ****Scalability and Maintainability:**** Design a modular architecture that can adapt to future needs and growth.

## 2. System Architecture

### 2.1. Key Components
The 10NetZero-FLRTS system comprises the following key components:

1. ****Telegram Bot & MiniApp (Primary User Interface):****
   * Built using the Telegram Bot API.
   * MiniApp for richer UI interactions within Telegram (e.g., displaying lists, review/confirmation screens).
   * Handles user input (natural language, button interactions) and displays system responses.

2. ****Flask Backend (Application Server):****
   * Python-based web server using the Flask framework.
   * Hosts the API endpoints for the Telegram bot/MiniApp.
   * Orchestrates interactions between other components (LLM, Todoist, Airtable).
   * Manages business logic, user authentication (for web admin UI), and permissions.

3. ****General Purpose LLM (e.g., OpenAI API):****
   * Used for parsing natural language input from users to create structured FLRTS data.
   * Identifies item types, extracts entities (titles, descriptions, sites, assignees, dates), and prepares text for Todoist.

4. ****Todoist (Task Management & Reminders):****
   * Integrated via its API.
   * Handles detailed NLP for dates, times, and recurring patterns for tasks and reminders.
   * Manages the lifecycle of tasks (creation, completion) and the delivery of reminders.
   * Serves as the source of truth for due dates and completion status of tasks managed within it.

5. ****Airtable (Data Storage):****
   * ****`10NetZero_Main_Datastore` Base:**** The central repository for master data (Sites, Personnel, Partners, Vendors, etc.).
   * ****`10NetZero-FLRTS` Base:**** Stores operational data specific to the FLRTS application, including `FLRTS_Items` and synced master data.

6. ****SiteGPT (Specialized RAG LLM - via TypingMind):****
   * As described in the user's "10NetZero Integrated Platform Design" PDF (page 2) [source: FULL%2010NZ%20Custom%20GPT%20w-%20Telegram%20Bot%20Design%20Doc.pdf.pdf].
   * A custom RAG-powered LLM backend trained on engineering documents.
   * Used for answering queries, drafting reports, and suggesting actions based on these specialized documents, distinct from the general FLRTS NLP.

7. ****Admin Web UI (Conceptual for MVP):****
   * A separate web interface for administrators to manage users, permissions, system settings, and potentially view/manage FLRTS items in bulk.

### 2.2. High-Level Data Flow for FLRTS Creation (Natural Language via Telegram)
1. ****User Input:**** User sends a natural language command to the Telegram bot/MiniApp.
2. ****Flask Backend:**** Receives the input.
3. ****General LLM Processing:**** Backend sends raw text to the General LLM (e.g., OpenAI) with a structured prompt (including "bumpers" like lists of sites/personnel). LLM returns a JSON object with parsed entities and a formatted string for Todoist.
4. ****Review & Correction (MiniApp):**** The parsed information is presented to the user for confirmation or conversational correction. This loop continues until the user confirms.
5. ****Todoist Integration:**** If the item is a Task or Reminder, the relevant text is sent to Todoist for task creation and detailed date/time parsing. Todoist returns its task ID and confirmed due date.
6. ****Airtable Update:****
   * If a new master entity (e.g., Site) was identified and confirmed for creation, the Flask backend first writes it to the `10NetZero_Main_Datastore` via API.
   * The FLRTS item is then created in the `10NetZero-FLRTS` base, linking to the Todoist Task ID (if applicable) and any master data (Sites, Personnel).
7. ****User Confirmation:**** Bot/MiniApp confirms item creation to the user.

## 3. Data Model (Airtable)

The system will utilize two primary Airtable bases:

### 3.1. `10NetZero_Main_Datastore` Base
This base serves as the Single Source of Truth (SSoT) for core business entities. It is designed as a single Airtable base containing multiple interlinked tables.

#### #### 3.1.1. `Sites` Table (Master)
* ****Purpose:**** Master list of all operational sites.
* ****Key Fields (See Appendix A for full list):****
  * `SiteID_PK` (Primary Key - e.g., Autonumber, Unique ID like "S001")
  * `SiteName` (Single Line Text, Required)
  * `SiteAddress_Street` (Single Line Text)
  * `SiteAddress_City` (Single Line Text)
  * `SiteAddress_State` (Single Line Text)
  * `SiteAddress_Zip` (Single Line Text)
  * `GPS_Coordinates` (Text or dedicated Lat/Long fields)
  * `SiteStatus` (Single Select: e.g., "Operational", "Under Construction", "Planned", "Decommissioned")
  * `Operator_Link` (Link to `Operators` table - one operator per site)
  * `Site_Partner_Assignments_Link` (Link to `Site_Partner_Assignments` table - shows all partner links for this site)
  * `Site_Vendor_Assignments_Link` (Link to `Site_Vendor_Assignments` table - shows all vendor assignments for this site)
  * `Licenses_Agreements_Link` (Link to `Licenses & Agreements` table - shows all contracts/permits associated with this site)
  * `Equipment_At_Site_Link` (Link to `Equipment` table - shows all general equipment at this site)
  * `ASICs_At_Site_Link` (Link to `ASICs` table - shows all ASICs at this site)
  * `SOP_Notes` (Long Text)
  * `IsActive` (Checkbox)
  * `Default_Lists_Created_by_App` (Checkbox, Default: FALSE - System field: Set to TRUE by the Flask application after successfully creating the site's default programmatic lists. Used by safety net automations.)

#### 3.1.2. `Personnel` Table (Master)
* ****Purpose:**** Master list of all employees/users who might interact with or be referenced in the system.
* ****Key Fields (See Appendix A for full list):****
  * `PersonnelID_PK` (Primary Key - e.g., Autonumber, Employee ID)
  * `FullName` (Single Line Text, Required)
  * `WorkEmail` (Email, Unique)
  * `TelegramUserID` (Text or Number, Unique, for bot interaction)
  * `TelegramHandle` (Text, Optional)
  * `RoleTitle` (Single Line Text, e.g., "Field Technician", "Ops Manager")
  * `Assigned_Equipment_Log_Link` (Link to `Employee_Equipment_Log` table - shows equipment assigned to this person)
  * `IsActive` (Checkbox)
  * `Default_Employee_Lists_Created` (Checkbox, Default: FALSE - System field: Set to TRUE by the Flask application after successfully creating the employee's default "Onboarding" list. Used by safety net automations.)
  
#### 3.1.3. `Partners` Table (Master)
* ****Purpose:**** Master list of partner organizations/individuals.
* ****Key Fields (See Appendix A for full list):****
  * `PartnerID_PK` (Primary Key - Autonumber or unique identifier)
  * `PartnerName` (Single Line Text, Required)
  * `PartnerType` (Single Select: e.g., "Investor", "Strategic Partner")
  * `ContactPerson` (Text)
  * `Email` (Email)
  * `Phone` (Phone)
  * `Address` (Long Text)
  * `Site_Assignments_Link` (Link to `Site_Partner_Assignments` table - shows all site assignments for this partner)
  * `Notes` (Long Text)

#### 3.1.4. `Site_Partner_Assignments` Table (Junction Table)
* ****Purpose:**** Links `Sites` and `Partners` to define specific partnership details for each site.
* ****Key Fields (See Appendix A for full list):****
  * `AssignmentID_PK` (Primary Key - Autonumber or unique ID)
  * `LinkedSite` (Link to `Sites` table - one site per assignment)
  * `LinkedPartner` (Link to `Partners` table - one partner per assignment)
  * `PartnershipStartDate` (Date)
  * `PartnerRoleInSite` (Single Select or Text, e.g., "Lead Investor," "Technical Advisor")
  * `OwnershipPercentage` (Percent)
  * `PartnerResponsibilities` (Long Text)
  * `10NZ_Responsibilities` (Long Text)
  * `PartnershipContract_Link` (Link to `Licenses & Agreements` table - if contract is stored there, or Attachment field here)
  * `Notes` (Long Text)

#### 3.1.5. `Vendors` Table (Master)
* ****Purpose:**** Master list of vendor organizations/individuals.
* ****Key Fields (See Appendix A for full list):****
  * `VendorID_PK` (Primary Key - Autonumber or unique identifier)
  * `VendorName` (Single Line Text, Required)
  * `ServiceType` (Single Select or Text, e.g., "Electrical Contractor," "Logistics," "Security")
  * `ContactPerson` (Text)
  * `Email` (Email)
  * `Phone` (Phone)
  * `Address` (Long Text)
  * `Site_Assignments_Link` (Link to `Site_Vendor_Assignments` table - shows all site assignments for this vendor)
  * `Notes` (Long Text)

#### 3.1.6. `Site_Vendor_Assignments` Table (Junction Table)
* ****Purpose:**** Links `Sites` and `Vendors` to define specific service or supply details for each site.
* ****Key Fields (See Appendix A for full list):****
  * `VendorAssignmentID_PK` (Primary Key - Autonumber or unique ID)
  * `LinkedSite` (Link to `Sites` table - one site per assignment)
  * `LinkedVendor` (Link to `Vendors` table - one vendor per assignment)
  * `ServiceStartDate` (Date)
  * `ServiceEndDate` (Date, optional)
  * `ServiceDescription_SiteSpecific` (Long Text)
  * `SiteSpecific_Pricing_Notes` (Long Text)
  * `VendorContract_Link` (Link to `Licenses & Agreements` table - if contract stored there, or Attachment field here)
  * `Notes` (Long Text)

#### 3.1.7. `Equipment` Table (Master - General Assets)
* ****Purpose:**** Master list of general physical assets (non-ASIC).
* ****Key Fields (See Appendix A for full list):****
  * `AssetTagID_PK` (Primary Key - Text, Unique, e.g., "10NZ-GEN-001")
  * `EquipmentName` (Text, e.g., "Honda GX390 Generator")
  * `EquipmentType` (Single Select: e.g., "Generator", "Pump", "Vehicle", "Heavy Equipment", "Power Tool", "IT Hardware - Laptop", "Safety Gear")
  * `Make` (Text)
  * `Model` (Text)
  * `SerialNumber` (Text, Unique if possible)
  * `SiteLocation_Link` (Link to `Sites` table - multiple links disallowed)
  * `Specifications` (Long Text)
  * `PurchaseDate` (Date)
  * `PurchasePrice` (Currency)
  * `PurchaseReceipt` (Attachment)
  * `CurrentStatus` (Single Select: e.g., "Operational", "Needs Maintenance", "Out of Service", "In Storage")
  * `Eq_Manual` (Attachment)
  * `EquipmentPictures` (Attachment)
  * `Employee_Log_Link` (Link to `Employee_Equipment_Log` table - shows assignment history)
  * `Notes` (Long Text)

#### 3.1.8. `ASICs` Table (Master - Mining Hardware)
* ****Purpose:**** Dedicated master list for Bitcoin mining hardware.
* ****Key Fields (See Appendix A for full list):****
  * `ASIC_ID_PK` (Primary Key - Text, e.g., Serial Number or unique Asset Tag)
  * `ASIC_Make` (Text or Single Select - e.g., "Bitmain," "MicroBT," "Canaan")
  * `ASIC_Model` (Text - e.g., "S19 XP," "M50S," "A1246")
  * `SerialNumber` (Text, Unique)
  * `SiteLocation_Link` (Link to `Sites` table)
  * `RackLocation_In_Site` (Text, e.g., "Container A, Rack 3, Shelf B, Unit 1")
  * `PurchaseDate` (Date)
  * `PurchasePrice` (Currency)
  * `CurrentStatus` (Single Select: "Mining", "Idle", "Needs Maintenance", "Error", "Offline", "Decommissioned")
  * `HashRate_Actual_THs` (Number)
  * `PowerConsumption_Actual_W` (Number)
  * `PoolAccount_Link` (Link to `Mining_Pool_Accounts` table)
  * `FirmwareVersion` (Text)
  * `IP_Address` (Text)
  * `MAC_Address` (Text)
  * `LastMaintenanceDate` (Date)
  * `WarrantyExpiryDate` (Date)
  * `ASIC_Manual` (Attachment - for user manuals or technical guides)
  * `Notes` (Long Text)

#### 3.1.9. `Employee_Equipment_Log` Table (Junction Table)
* ****Purpose:**** Tracks equipment/tools lent to employees.
* ****Key Fields (See Appendix A for full list):****
  * `LogID_PK` (Primary Key - Autonumber)
  * `LinkedEmployee` (Link to `Personnel` table)
  * `LinkedEquipment` (Link to `Equipment` table)
  * `DateIssued` (Date)
  * `DateReturned` (Date, null if currently issued)
  * `ConditionIssued` (Single Select or Text)
  * `ConditionReturned` (Single Select or Text)
  * `Notes` (Long Text)

#### 3.1.10. `Operators` Table (Master)
* ****Purpose:**** Master list of entities operating the wells/sites.
* ****Key Fields (See Appendix A for full list):****
  * `OperatorID_PK` (Primary Key - Autonumber or unique identifier)
  * `OperatorName` (Text, Required)
  * `ContactPerson` (Text)
  * `Email` (Email)
  * `Phone` (Phone)
  * `Address` (Long Text)
  * `OperatedSites_Link` (Link to `Sites` table - shows all sites this entity operates)
  * `Notes` (Long Text)

#### 3.1.11. `Licenses & Agreements` Table (Master)
* ****Purpose:**** Consolidated repository for contracts, permits, licenses, and other agreements.
* ****Key Fields (See Appendix A for full list):****
  * `AgreementID_PK` (Primary Key - Autonumber or unique identifier)
  * `AgreementName` (Text, Required, e.g., "Site Bravo Gas Purchase FY2025")
  * `AgreementType` (Single Select: "Gas Purchase Agreement", "Permit", "License", "Service Agreement", "Lease Agreement", "Partner Agreement", "Vendor Agreement", "NDA")
  * `Status` (Single Select: "Active", "Expired", "Pending", "Terminated", "Under Review")
  * `CounterpartyName` (Text - name of the other party)
  * `Counterparty_Link_Partner` (Link to `Partners` table, optional)
  * `Counterparty_Link_Vendor` (Link to `Vendors` table, optional)
  * `Counterparty_Link_Operator` (Link to `Operators` table, optional)
  * `Site_Link` (Link to `Sites` table - can allow multiple if agreement covers multiple sites)
  * `EffectiveDate` (Date)
  * `ExpiryDate` (Date)
  * `RenewalReminderDate` (Date)
  * `Document` (Attachment - for the scanned agreement/permit)
  * `KeyTerms_Summary` (Long Text)
  * `Notes` (Long Text)

#### 3.1.12. `Mining_Pool_Accounts` Table (Master)
* ****Purpose:**** Information about accounts with Bitcoin mining pools.
* ****Key Fields (See Appendix A for full list):****
  * `PoolAccountID_PK` (Primary Key - Autonumber or unique identifier)
  * `PoolName` (Text, Required)
  * `PoolWebsite` (URL)
  * `AccountUsername` (Text)
  * `DefaultWorkerNameBase` (Text)
  * `StratumURL_Primary` (Text)
  * `StratumURL_Backup` (Text, optional)
  * `ExpectedFeePercentage` (Percent)
  * `CurrentTotalHashRate` (Number - Stores the current total hashrate for this pool account. Note: This field is intended to be updated periodically by an external process or script that pulls data from the mining pool's API.)
  * `PayoutWalletAddress` (Text - consider security implications if storing actual private keys, which is not recommended here)
  * `API_Key_ForStats` (Text - store securely, for use by backend processes to query pool APIs)
  * `ASICs_Using_Pool_Link` (Link to `ASICs` table - shows ASICs configured for this pool account)
  * `Notes` (Long Text)

### 3.2. `10NetZero-FLRTS` Base
This base holds operational data for the FLRTS application and synced data from the Main Datastore.

#### 3.2.1. `Synced_Sites` Table
* ****Source:**** One-way sync from `Sites` table in `10NetZero_Main_Datastore`.
* ****Purpose:**** Provides a read-only local reference to sites for linking within the FLRTS base.
* ****Fields:**** Mirrors the `Sites` table from the Main Datastore.

#### 3.2.2. `Synced_Personnel` Table
* ****Source:**** One-way sync from `Personnel` table in `10NetZero_Main_Datastore`.
* ****Purpose:**** Provides a read-only local reference to personnel for linking.
* ****Fields:**** Mirrors the `Personnel` table from the Main Datastore.

#### 3.2.3. `Users` Table (FLRTS App Specific)
* ****Purpose:**** Manages FLRTS application-specific user settings, roles, and permissions. Links to the master personnel record.
* ****Key Fields (See Appendix A for full list):****
  * `UserID_PK` (Primary Key - Autonumber)
  * `Personnel_Link` (Link to `Synced_Personnel` table, Required, Unique)
  * `FLRTS_Role` (Single Select: "admin", "user" - as per PDF page 3-4 [source: FULL%2010NZ%20Custom%20GPT%20w-%20Telegram%20Bot%20Design%20Doc.pdf.pdf])
  * `PasswordHash` (Text - conceptual, actual storage/auth handled by Flask backend's auth system)
  * Permission Flags (Checkboxes - as per PDF pages 3, 6, 7 [source: FULL%2010NZ%20Custom%20GPT%20w-%20Telegram%20Bot%20Design%20Doc.pdf.pdf]): `Can_Create_Site`, `Can_Configure_Integrations`, etc. (detailed in Appendix A).
  * `DateAdded` (Created Time)


#### **3.2.4.** FLRTS_Items **Table**
* **Purpose:** Core table for all FLRTS items.
* **Key Fields (See Appendix A for full list):**
  * ItemID_PK (Primary Key - Autonumber or UUID)
  * ItemType (Single Select: "Field Report", "List", "Reminder", "Task", "Subtask")
  * Title (Single Line Text, Required - content varies by ItemType, LLM sets to null for new Field Reports)
  * Description (Long Text - main content for Field Reports)
  * Status (Single Select: "Open", "In Progress", "Completed", "Pending", "Archived")
  * Priority (Single Select: "Low", "Medium", "High")
  * DueDate (Date, with time option - authoritative source is Todoist if linked)
  * ReminderTime (Date, with time option - for items where Todoist reminder is not primary)
  * CreatedDate (Created Time)
  * CreatedBy_UserLink (Link to Users table)
  * LastModifiedDate (Last Modified Time)
  * AssignedTo_UserLink (Link to Users table, allow multiple)
  * Site_Link (Link to Synced_Sites table)
  * Scope (Single Select: "site", "general")
  * Visibility (Single Select: "public", "private")
  * ParentItem_Link (Link to another FLRTS_Items record - for subtasks or items in a list)
  * TodoistTaskID (Text, Unique - if synced with Todoist)
  * RawTelegramInput (Long Text)
  * ParsedLLM_JSON (Long Text, AI-enabled in Airtable optional - stores JSON from General LLM)
  * Source (Single Select: "Telegram", "MiniApp", "AdminUI", "SiteGPT Suggestion", "Todoist Sync")
  * IsSystemGenerated **(Checkbox, Default: FALSE)** - Added (TRUE for lists programmatically created by the system, e.g., default site lists)
  * SystemListCategory **(Single Select, Optional)** - Added (e.g., "Site_Tools", "Site_Tasks_Master", "Site_Shopping"; null for user-created items)
  * IsArchived (Checkbox)
  * ArchivedBy_UserLink (Link to Users table)
  * ArchivedAt_Timestamp (Date, with time option)
  * DoneAt_Timestamp (Date, with time option)


#### 3.2.5. `Field_Report_Edits` Table
* **Purpose:** Stores append-only edits for Field Reports, ensuring history is maintained (as per PDF page 8 [source: FULL%2010NZ%20Custom%20GPT%20w-%20Telegram%20Bot%20Design%20Doc.pdf.pdf]).
* **Key Fields (See Appendix A for full list):**
  * `EditID_PK` (Primary Key - Autonumber)
  * `ParentFieldReport_Link` (Link to `FLRTS_Items` where `ItemType`="Field Report", Required)
  * `Author_UserLink` (Link to `Users` table, Required)
  * `Timestamp` (Created Time)
  * `EditText` (Long Text, Required)

### 3.3. Data Synchronization Strategy

#### 3.3.1. Main Datastore to FLRTS Base (Airtable Sync)
* `Sites` and `Personnel` tables from `10NetZero_Main_Datastore` will be one-way synced to `Synced_Sites` and `Synced_Personnel` in the `10NetZero-FLRTS` base using Airtable's native sync feature.
* This provides read-access to master data within the FLRTS application context.

#### 3.3.2. FLRTS App Writing to Main Datastore (API)
* If a new Site or Personnel needs to be created via the FLRTS app (e.g., user specifies a new site during task creation):
  1. The Flask backend will first make an API call to the `10NetZero_Main_Datastore` to create the new record (e.g., in the master `Sites` table).
  2. The backend will use the `Record ID` returned from this API call to immediately link the new FLRTS item in the `10NetZero-FLRTS` base.
  3. This ensures data integrity and correct linking, even before Airtable's native sync updates the corresponding `Synced_Sites` or `Synced_Personnel` table.

#### 3.3.3. Todoist and Airtable Synchronization
* **Source of Truth:**
  * Airtable is the SSoT for the complete FLRTS item record and its 10NetZero-specific metadata.
  * Todoist is the SSoT for due dates, completion status, and reminder delivery for items it manages.
* **Initial Creation:** `TodoistTaskID` from Todoist is stored in the Airtable `FLRTS_Items` record. The `DueDate` in Airtable is populated from Todoist's parsed date.
* **Updates (Todoist to Airtable):**
  * Primarily via Todoist Webhooks: When a task is completed, due date changed, etc., in Todoist, a webhook notifies the Flask backend.
  * The Flask backend updates the corresponding `FLRTS_Items` record in Airtable (identified by `TodoistTaskID`).
  * Polling Todoist for changes can be an MVP alternative if webhooks are complex initially.
* **Updates (Airtable to Todoist - Minimized for MVP):** Changes to core task properties (status, due date) in Airtable should ideally be initiated via actions that first update Todoist, with changes flowing back. Direct edits in Airtable to these fields might not sync to Todoist in MVP unless explicitly built.

## 4. User Roles, Permissions, and Access Control

### 4.1. User Roles (in `Users` table, `FLRTS_Role` field - MVP Definitions)

* **`admin`**:
  * Unrestricted "god mode" access to all system functionalities, data (FLRTS items and all master data records), logs, and system configurations.
  * Can perform any action on any FLRTS item.
  * Can create, read, update, and delete any master data record via the Admin Web UI.
  * Manages user accounts and their roles/permissions.
* **`manager`**:
  * **FLRTS Items:**
    * Can read all FLRTS items (Tasks, System-Generated Site Lists, Reminders, Field Reports).
    * Can create new Tasks, Reminders, and Field Reports via Telegram.
    * Can add items to, and remove items from, the system-generated public Site Lists via Telegram.
    * Can edit FLRTS items they created.
    * Can view all Tasks and Reminders in the system, regardless of creator or assignee (overrides privacy for `user` roles).
    * Can assign tasks/reminders to any personnel.
    * Can append notes to any Field Report.
  * **Master Data & System Functions (Primarily via Admin Web UI):**
    * Can read/view all dynamic global master data views according to role-specific rules (see 4.4.2). Specifically, can view: Sites, Personnel, Partners, Vendors, Equipment, ASICs (all fields), Operators, Licenses & Agreements, Mining Pool Accounts.
    * Can create new Site records (triggering programmatic site list creation) via the Admin Web UI or authorized application interfaces.
    * Can create new Personnel records (triggering programmatic "Onboarding" list creation) via the Admin Web UI or authorized application interfaces.
    * Can edit master data records (Sites, Personnel, Equipment, ASICs, etc.) via the Admin Web UI.
    * Cannot edit the name/description of system-generated Site Lists (Admin only).
* **`user`**:
  * **FLRTS Items:**
    * Can read all FLRTS items (Tasks, System-Generated Site Lists, Reminders, Field Reports).
    * Can create new Tasks, Reminders, and Field Reports via Telegram.
    * Can add items to, and remove items from, the system-generated public Site Lists via Telegram.
    * Can edit FLRTS items they created.
    * Can only view Tasks and Reminders that they created OR are assigned to.
    * Can assign tasks/reminders they create to any personnel.
    * Can append notes to any Field Report.
  * **Master Data & System Functions:**
    * Can read/view dynamic global master data views according to role-specific rules (see 4.4.2). Specifically, can view: Sites, Personnel, Vendors, Equipment, ASICs (all fields including `PurchasePrice`), Operators.
    * Cannot view: Partners, Licenses & Agreements, Mining Pool Accounts.
    * Cannot create new Site or Personnel records.
    * Cannot edit any master data records.
    * Cannot edit the name/description of system-generated Site Lists (Admin only).


### 4.2. Permission Flags (Checkbox fields in the `Users` table - MVP Focus)

For MVP, read access to FLRTS items is global. Read access to dynamic master data views is role-defined. Permission flags will primarily govern action capabilities. The following flags are conceptual for backend logic:

* **General FLRTS Actions (Default for `user`, `manager`, `admin`):**
  * `Can_Create_Task`
  * `Can_Create_Reminder`
  * `Can_Create_Field_Report`
  * `Can_Manage_Items_In_System_Lists` (Add/remove items from system-generated site lists)
  * `Can_Edit_Own_FLRTS_Items` (Title, description, etc. of tasks, reminders, FRs they created)
  * `Can_Assign_FLRTS_Items` (Assign tasks/reminders they create)
  * `Can_Append_To_Field_Reports`
* **Manager & Admin Specific FLRTS Actions:**
  * `Can_View_All_Tasks_And_Reminders` (Allows viewing tasks/reminders not created by or assigned to them; granted to `manager`, `admin`)
* **Master Data & System Creation (Primarily `manager`, `admin` via Admin Web UI):**
  * `Can_Create_Sites_In_Main_Datastore` (Granted to `manager`, `admin`)
  * `Can_Create_Personnel_In_Main_Datastore` (Granted to `manager`, `admin`)
* **Master Data Viewing (Role-Dependent, flags for explicitness if not purely role-driven by API):**
  * `Can_View_Partners_Data` (Granted to `manager`, `admin`)
  * `Can_View_Licenses_Data` (Granted to `manager`, `admin`)
  * `Can_View_Mining_Pool_Data` (Granted to `manager`, `admin`)
  * *(Note: Viewing for Sites, Personnel, Vendors, Equipment, ASICs, Operators is granted to all roles or as specified in 4.1, so specific flags might be redundant if API logic is role-name driven for these).*
* **Admin-Only System Level (Implicit or explicit flags for `admin` role):**
  * `Can_Manage_All_FLRTS_Items_Unrestricted` (e.g., edit any field of any item, delete any item including system lists)
  * `Can_Manage_Users_And_Permissions`
  * `Can_Configure_System_Settings_And_Integrations`
  * `Can_Access_Full_Audit_Logs_And_DB_Tools`
  * `Can_Edit_System_List_Properties` (e.g., rename a system-generated site list)

### 4.3. FLRTS Item Scope and Visibility Rules (MVP)

* **`Scope`**:
  * This field on `FLRTS_Items` remains relevant for categorizing items.
  * `general`: Item is not tied to a specific operational site. (e.g., Employee "Onboarding" list, general tasks).
  * `site`: Item is linked to a specific record in the `Synced_Sites` table (e.g., System-generated site lists, site-specific tasks or field reports).
* **`Visibility`**:
  * For MVP, all `FLRTS_Items` (Tasks, System-Generated Site Lists, Reminders, Field Reports) are considered **globally readable by all authenticated users** (`user`, `manager`, `admin`).
  * The `Visibility` field in the `FLRTS_Items` table, if used, should default to "public" for all newly created FLRTS items. Its primary role in restricting read access for FLRTS items is diminished for MVP in favor of this open model.
  * Specific exceptions to global read access for FLRTS items (e.g., a `user` only seeing their own or assigned tasks/reminders unless they are a `manager`) are handled by role definition (see 4.1) and backend logic rather than the `Visibility` flag alone.

### 4.4. Access Control Enforcement (MVP)

Permissions will be enforced primarily in the **Flask backend**.

1. **FLRTS Item Access:**
   * **Read Access:** Generally open for all FLRTS items to all roles. Specific logic for `user` role viewing only their created/assigned Tasks/Reminders (unless user is a `manager` or `admin` who have `Can_View_All_Tasks_And_Reminders`) will be enforced in the backend when querying/serving these items.
   * **Action Permissions (Create, Edit, Delete, Assign, Add/Remove from Lists):** The backend will check the authenticated user's `FLRTS_Role` and relevant permission flags (see 4.2) against the attempted action and the target FLRTS item's properties (e.g., `CreatedBy_UserLink` for editing own items, `ItemType` for allowed actions).
   * Editing user-created FLRTS items is possible via Telegram (NLP, conversational correction).
   * Managing items within system-generated Site Lists (add/remove) is possible via Telegram.
   * Editing core properties of system-generated Site Lists (e.g., `Title`) is Admin-only, likely via Admin Web UI.

2. **Dynamic Global Master Data View Access:**
   * **Read Access:** The Flask API endpoints serving these views (e.g., `/api/sites`, `/api/partners`, `/api/asics`) will check the authenticated user's `FLRTS_Role` to determine if they are permitted to view data from that specific master data table according to the rules outlined in section 4.1 (e.g., Partners data only for Managers/Admins).
   * These views are **read-only** when accessed via Telegram or the FLRTS MiniApp.

3. **Master Data Record Editing (CUD Operations):**
   * Creation, update, and deletion of master data records (e.g., Sites, Personnel, Equipment, ASICs) are restricted to `Managers` and `Admins`.
   * These CUD operations on master data are performed exclusively via the **Admin Web UI** component of the Flask application, not through Telegram bot commands.

4. **Site-Specific Access (for Site-Scoped Items/Data):**
   * For MVP, all authenticated users (`user`, `manager`, `admin`) are assumed to have access to all operational sites. This simplifies permission checks related to site-scoping for this initial version. Future versions may introduce site-specific user access restrictions.

5. **User Interface (UI) Awareness:**
   * The Telegram Bot/MiniApp and Admin Web UI will dynamically render options and display data based on these enforced permissions. Elements or actions will be hidden or disabled if the current user is not permitted (e.g., an "edit master record" button would only appear in the Admin Web UI for a Manager or Admin).

## 5. User Interface (UI) and User Experience (UX) Design

### 5.1. Primary Interface: Telegram Bot & MiniApp

#### 5.1.1. Guiding Principles
* **Natural Language First:** User interaction for creating and modifying FLRTS items will prioritize natural language input via the Telegram chat interface or a prominent input field in the MiniApp.
* **Conversational Correction:** Instead of immediately falling back to forms upon NLP ambiguity, the system will present its interpretation to the user and allow for conversational, natural language corrections.
* **Mobile-First & Field-Usability:** Interactions will be designed for quick and easy use on mobile devices, often with one hand, by users in field environments.
* **Context-Aware:** The MiniApp will strive to present relevant information and actions based on the user's current context (e.g., selected item, current view).

#### 5.1.2. FLRTS Item Creation Flow (via Telegram/MiniApp NLP)
As detailed in Section 2.2, this involves:
1. User's natural language input.
2. Backend sends text to General LLM with "bumpers" (valid sites, personnel, etc.).
3. LLM returns structured JSON.
4. MiniApp displays parsed information for user review.
5. User confirms or provides natural language corrections (iterative loop with LLM via backend).
6. Upon confirmation, data is sent to Todoist (if applicable) and Airtable.
7. Final confirmation to user.

#### 5.1.3. Telegram MiniApp - MVP Views and Actions
* **Main View:**
  * Prominent natural language input field: "What needs to be done?" or similar.
  * Optional quick-select buttons for `ItemType` (e.g., `[+Task]`, `[+List]`) to provide hints to the LLM if desired by the user.
  * Tabs/Sections for viewing FLRTS items:
    * "My Open Tasks" (Tasks assigned to user or created by user, not completed/archived)
    * "My Reminders" (Reminder `ItemType` or Tasks with upcoming `ReminderTime`)
    * "My Lists"
    * "My Field Reports"
    * (Future: "All Site Tasks for [Site X]" if a site context is active)
* **Item List View (for each tab):**
  * Concise display: Title, DueDate (if any), Priority, Site (if any).
  * Tap to open Detail View.
* **Item Detail View:**
  * Displays all relevant fields for the selected item.
  * **Actions (permission-dependent):**
    * "Mark Complete" (for Tasks/Reminders - updates Todoist/Airtable).
    * "Archive Item"
    * "Edit Item" (initiates a conversational correction flow with the LLM, or for V2, a focused field editor).
    * "Assign"
    * For Lists: "View Items in List", "Add Item to This List".
    * For Field Reports: "View Content", "Append Note" (using `Field_Report_Edits` table).
* **Review & Confirmation Screen:** (As part of the creation/correction flow) Displays the LLM's interpretation of the user's natural language input before committing changes.

#### 5.1.4. Forms as Fallback/Alternative
* While NLP is primary, the MiniApp might offer an "Advanced Entry" or "Manual Form" option for each FLRTS type if users prefer or if NLP struggles exceptionally (though conversational correction is the preferred first approach to NLP errors).
* These forms would be simple, mobile-friendly, and pre-fill from any prior NLP attempt.

### 5.2. Admin Web UI (Conceptual for MVP)
* **Purpose:** For administrators to perform actions not easily suited to the bot/MiniApp interface.
* **Potential MVP Features:**
  * User Management: View users, assign `FLRTS_Role`, manage permission flags (editing records in the `Users` table).
  * Master Data Management: Interface to view/edit `Sites`, `Personnel`, `Partners`, `Vendors` in the `10NetZero_Main_Datastore` (if direct Airtable access is not preferred for admins).
  * FLRTS Item Overview: A tabular view of all `FLRTS_Items`, with filtering and searching. Potentially bulk actions.
  * System Logs/Audit Trail Viewer (if implemented).
  * Configuration for Integrations (e.g., Todoist API keys, Webhook URLs).
  * Access to SiteGPT console (as per PDF page 3) [source: FULL%2010NZ%20Custom%20GPT%20w-%20Telegram%20Bot%20Design%20Doc.pdf.pdf].

## 6. LLM Integration & Prompting

### 6.1. General Purpose LLM (e.g., OpenAI API) for FLRTS Creation

#### 6.1.1. Role
* To parse raw natural language input from users via the Telegram bot/MiniApp.
* To identify user intent (FLRTS item type) and extract key entities (title, description, site, assignee, priority, due date phrases, etc.).
* To provide a structured JSON output for backend processing and user review.
* To formulate a concise string suitable for Todoist's NLP.
* To support the conversational correction loop by re-processing input based on user feedback and prior context.

#### **6.1.2. Initial Prompt Design (Key Elements)**
This prompt is for the General Purpose LLM (e.g., OpenAI API) to parse initial user input for FLRTS creation.
**(Prompt Excerpt - showing revised instructions for Entity Extraction and updated Examples)**
... (Previous parts of the prompt: Role setting, User Input placeholder, Contextual Information/Bumpers placeholder) ...
**Instructions (for the LLM):**
**1** **Identify Item Type:** Determine if the user wants to create a "Field Report", "List", "Reminder", "Task", or "Subtask". If it's a "Subtask", also identify the ParentItem_Link if mentioned or implied.
**2** **Extract Entities:** Extract the following information if present. If not present, use null for the value.
	* ItemType: (As identified above)
	* Title:
		* For **Task, Subtask, Reminder**: Capture the main subject/action of the item here. This will be the primary text from the user for these types.
		* For **List**: Capture the name/title of the list here.
		* For **Field Report**: Set this to null. The backend system will programmatically generate the title for Field Reports.
	* Description:
		* For **Task, Subtask, Reminder**: If the user provides distinct additional details or a longer explanation beyond the main action/subject, capture them here. Often, this may be null if the input is concise and fully captured in Title.
		* For **List**: Capture any additional descriptive text for the list if provided by the user. May be null.
		* For **Field Report**: Capture the full content or body of the field report here. This is the primary input from the user for a field report.
	* Site_Link: The SiteID_PK if a valid site is mentioned. Match against [LIST_OF_SITES_JSON_ARRAY].
	* AssignedTo_UserLink: An array of PersonnelID_PKs if valid personnel are mentioned as assignees. Match against [LIST_OF_PERSONNEL_JSON_ARRAY].
	* Priority: ("Low", "Medium", "High").
	* DueDate_Phrase: Any phrase related to due date, e.g., "tomorrow", "next Friday".
	* ReminderTime_Phrase: Any phrase related to a specific reminder time.
	* Scope: ("site", "general"). Default to "general" unless a Site_Link is identified, then default to "site".
	* Visibility: ("public", "private"). Default to "private".
	* ParentItem_Link: The ItemID_PK of the parent item if this is a subtask or an item being added to an existing list. Match against [LIST_OF_EXISTING_FLRTS_LISTS_JSON_ARRAY] if adding to a list.
**3** **Handle Ambiguity & Site Clarification for Field Reports:**
	* If any part of the input is ambiguous or unclear, or if you have to make a significant assumption, detail this in the parsing_notes field.
	* If ItemType is "Field Report" and no site is specified by the user, set Site_Link to null and note in parsing_notes that "No site specified for Field Report." The backend will handle prompting the user for clarification.
**4** **Formulate Todoist Text:** Create a concise string in text_for_todoist. This string should ideally include the title (or main action for tasks/reminders), due date phrase, priority, and assignee names (not IDs) if applicable. E.g., "Fix leaking faucet at Main Office tomorrow p1 @AliceWonderland". For Field Reports, this can be null.
**5** **Output Format:** Return a single JSON object with the structure previously defined (ItemType, Title, Description, Site_Link, etc., including RawTelegramInput, parsing_notes, text_for_todoist).

⠀**Example User Input (Task):** "Need to schedule quarterly maintenance for the primary generator at North Facility for next Wednesday, assign to Bob The Builder, high priority."

**Example Output (Illustrative for Task):**
```json
{
  "ItemType": "Task",
  "Title": "Schedule quarterly maintenance for the primary generator at North Facility",
  "Description": null,
  "Site_Link": "S002", // Assuming North Facility is S002
  "AssignedTo_UserLink": ["P002"], // Assuming Bob The Builder is P002
  "Priority": "High",
  "DueDate_Phrase": "next Wednesday",
  "ReminderTime_Phrase": null,
  "Scope": "site",
  "Visibility": "private",
  "ParentItem_Link": null,
  "RawTelegramInput": "Need to schedule quarterly maintenance for the primary generator at North Facility for next Wednesday, assign to Bob The Builder, high priority.",
  "parsing_notes": null,
  "text_for_todoist": "Schedule quarterly maintenance for the primary generator at North Facility next Wednesday p1 @BobTheBuilder"
}
```

**Example User Input (Field Report):** 
"Field report from today: West perimeter fence check completed. Section near gate 3 needs repair."

**Example Output (Illustrative for Field Report):**
```json
{
  "ItemType": "Field Report",
  "Title": null, // Backend will generate this
  "Description": "West perimeter fence check completed. Section near gate 3 needs repair.",
  "Site_Link": null, // Assuming no site was mentioned in this specific input
  "AssignedTo_UserLink": [],
  "Priority": null,
  "DueDate_Phrase": null,
  "ReminderTime_Phrase": null,
  "Scope": "general", // Default, or could be "site" if a site was implied by user context not in this text
  "Visibility": "private",
  "ParentItem_Link": null,
  "RawTelegramInput": "Field report from today: West perimeter fence check completed. Section near gate 3 needs repair.",
  "parsing_notes": "No site specified for Field Report. Backend to clarify with user.",
  "text_for_todoist": null
}
```

#### 6.1.3. Prompt for Conversational Corrections
* This prompt will be used when the user indicates changes are needed after the initial LLM interpretation.
* **Inputs to this prompt:**
  * The user's corrective natural language phrase (e.g., "Change the site to Site B and the assignee to Sarah").
  * The *previous JSON output* from the LLM (the one the user wants to correct).
  * The original lists of "bumpers" (sites, personnel, etc.) for validation.
* **Instructions to LLM:**
  * "The user wants to modify the previously understood FLRTS item. Here is the previous interpretation (JSON): `[PREVIOUS_LLM_JSON]`."
  * "Here is the user's correction: `[USER_CORRECTION_TEXT]`."
  * "Update the previous JSON based on the user's correction. Ensure all fields remain valid according to the provided lists of sites, personnel, etc. Pay close attention to the specific changes requested."
  * "Return the complete, updated JSON object in the same format as before."
  * Update `parsing_notes` if the correction introduces new ambiguities or resolves old ones.

### 6.2. SiteGPT (Specialized RAG LLM via TypingMind)

#### 6.2.1. Role
* As defined in the user's "10NetZero Integrated Platform Design" PDF (page 2) [source: FULL%2010NZ%20Custom%20GPT%20w-%20Telegram%20Bot%20Design%20Doc.pdf.pdf]: answer queries, draft reports, and suggest actions based on uploaded engineering documents.
* This LLM is **not** used for the primary parsing of user commands to create FLRTS items from Telegram.

#### 6.2.2. Integration Points (Conceptual)
* **Admin Web UI:** May have a "GPT Console" or "Ask SiteGPT" section for admins/users to query the document knowledge base.
* **FLRTS Item Enrichment (Future):** SiteGPT could potentially analyze the content of `FLRTS_Items` (e.g., Field Reports) and suggest related documents or insights.
* **Task/Report Generation from Notes (Future):** A user might provide unstructured notes (perhaps related to a site or piece of equipment documented in SiteGPT's knowledge base), and SiteGPT could help structure these into a draft Field Report or suggest relevant Tasks. This output would then feed into the standard FLRTS creation flow.

## ## 7. Todoist Integration Details

This section outlines the specifics of how the 10NetZero-FLRTS system integrates with Todoist for task and reminder management.

### 7.1. Todoist API Endpoints Used (REST API v2)

The 10NetZero-FLRTS system will primarily use the following Todoist REST API v2 endpoints:

* **`POST /rest/v2/tasks`**:
  * **Purpose:** To create new tasks in Todoist.
  * **10NetZero Usage:** When a user creates a "Task" or "Reminder" FLRTS item, the Flask backend will call this endpoint. The `content` field of the API call will contain the `text_for_todoist` string (generated by the General LLM and confirmed by the user), which includes the task description, due date phrases, priorities (e.g., `p1`), and potentially assignee hints for Todoist's NLP.
  * Tasks will likely be created in the system-wide Todoist account's inbox or a designated project for FLRTS items.
  * The API response will provide the `id` of the created Todoist task, which will be stored in the `FLRTS_Items.TodoistTaskID` field.

* **`POST /rest/v2/tasks/{task_id}/close`**:
  * **Purpose:** To mark a task as completed in Todoist.
  * **10NetZero Usage:** When a user marks a task as complete in the 10NetZero-FLRTS interface (Telegram/MiniApp), the Flask backend will call this endpoint using the stored `TodoistTaskID`.

* **`GET /rest/v2/tasks/{task_id}`**:
  * **Purpose:** To retrieve details of a specific task.
  * **10NetZero Usage:** Could be used for ad-hoc checks or to reconcile task status if a webhook event is suspected to have been missed. However, webhook-driven updates (Section 7.4) are the preferred method for ongoing synchronization.

* **`POST /rest/v2/tasks/{task_id}` (Update Task)**:
  * **Purpose:** To update an existing task in Todoist (e.g., change content, due date).
  * **10NetZero Usage:** If a user edits a task's details (e.g., title, description, due date phrase) within 10NetZero-FLRTS *before* it's completed, the backend will use this endpoint to update the corresponding Todoist task.

### 7.2. Data Mapping and Flow between FLRTS_Items and Todoist Tasks

This section details how information is exchanged and mapped for "Task" or "Reminder" type `FLRTS_Items`.

**Guiding Principles:**
* **Airtable (`FLRTS_Items` table) is the SSoT for:** The complete FLRTS item record, its 10NetZero-specific metadata (e.g., `Site_Link`, `Scope`, `CreatedBy_UserLink`, `Source`, `SystemListCategory`), the LLM's interpretation (`ParsedLLM_JSON`, `RawTelegramInput`), and the link to the Todoist task (`TodoistTaskID`).
* **Todoist is the SSoT for:** The precise, NLP-parsed due dates/times, the actual delivery of reminders (for the system Todoist account), and the task completion status.

**Data Flow - FLRTS Item Creation (Task/Reminder):**
1. **User Input (Telegram/MiniApp):** User provides natural language.
2. **LLM Processing (Flask Backend):** General LLM parses input, generates structured JSON for Airtable fields, and a `text_for_todoist` string.
3. **User Review & Correction (MiniApp):** User confirms/corrects the LLM's interpretation.
4. **Todoist Task Creation (Flask Backend):**
   * Flask backend sends the `text_for_todoist` to `POST /rest/v2/tasks`.
   * Todoist processes this text, creating a task, parsing the due date, priority, etc.
   * Todoist returns its `Task ID` and the parsed `due` object.
5. **Airtable `FLRTS_Items` Record Creation (Flask Backend):**
   * A new record is created in `FLRTS_Items`.
   * Key Mappings:
     * `FLRTS_Items.TodoistTaskID` <-> Todoist `Task ID`.
     * `FLRTS_Items.Title` <-> Derived from LLM parsing; primary action text sent to Todoist.
     * `FLRTS_Items.Description` <-> LLM-parsed description.
     * `FLRTS_Items.DueDate` <-> Specific due date/time returned by Todoist.
     * `FLRTS_Items.Priority` <-> LLM-parsed priority (also sent to Todoist via text).
     * `FLRTS_Items.Status` <-> Initially "Open" or "Pending".
     * Other FLRTS-specific fields are populated.
6. **User Confirmation (Telegram/MiniApp):** Confirmation of item creation.

**Data Flow - Task Updates:**
* **Update Initiated in 10NetZero-FLRTS:**
  1. User makes a change (e.g., edits title, due date phrase).
  2. Flask backend calls `POST /rest/v2/tasks/{task_id}` on Todoist with updated info.
  3. Todoist updates its task, returns the new state.
  4. Flask backend updates `FLRTS_Items` in Airtable (especially `Title`, `DueDate` from Todoist's interpretation).
* **Update Initiated in Todoist (via Webhook):**
  1. Change occurs in Todoist (e.g., task completed by Todoist reminder system).
  2. Todoist sends a webhook event to the Flask backend (see Section 7.4).
  3. Flask backend identifies the `FLRTS_Item` via `TodoistTaskID`.
  4. Flask backend updates `FLRTS_Items` (e.g., `Status` to "Completed", `DoneAt_Timestamp`, `DueDate`).

**Key Field Mappings Summary:**

| FLRTS_Items Field      | Todoist Task Attribute                     | Direction of Sync & SSoT Domain                                                        | Notes                                                                                                                                                             |
| :--------------------- | :----------------------------------------- | :------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `TodoistTaskID`        | `id`                                       | Todoist -> Airtable (Todoist for ID)                                                   | Primary link.                                                                                                                                                     |
| `Title` / `Description`| `content` / `description`                  | Bi-directional (Airtable for full FLRTS context)                                       | `text_for_todoist` forms initial `content`. Edits sync.                                                                                                           |
| `DueDate`              | `due` (object)                             | Todoist -> Airtable (Todoist for parsed due date)                                      | User provides phrase, Todoist parses, Airtable stores Todoist's final version.                                                                                    |
| `Priority`             | `priority` (1-4)                           | Bi-directional (Airtable for NLP parse, Todoist for internal value)                    | LLM suggests (e.g., "High"), sent to Todoist as "p1"/"p2" etc. in `text_for_todoist`. Updates sync.                                                              |
| `Status`               | Task completion state                      | Todoist -> Airtable (Todoist for completion)                                           | Webhook from Todoist updates Airtable.                                                                                                                            |
| `AssignedTo_UserLink`  | Assignee hint in `content`                 | 10NetZero -> Todoist (for initial NLP parsing only)                                    | Airtable `AssignedTo_UserLink` is primary for 10NetZero assignment. Todoist may parse assignee names from `text_for_todoist` for its own internal assignment within the system account if that assignee is part of the system Todoist account. |

### 7.3. Todoist User Authentication/Token Management

**Recommendation for MVP: System-Wide Todoist Account.**
This approach is favored for its simplicity in MVP.

* **Concept:** A single, dedicated Todoist account (e.g., `flrts_system@your_domain.com`) is used by the 10NetZero-FLRTS backend. All tasks created by any user via the FLRTS app are created within this one Todoist account.
* **Authentication:**
  * The API token for this single Todoist account is securely stored in the Flask backend's configuration.
  * **Configuration Value:** `___TODOIST_SYSTEM_API_TOKEN___`
  * This token will be used for all API calls from the Flask backend to Todoist.
* **Rationale:**
  * Significantly simpler to implement than individual user OAuth flows.
  * Centralizes all FLRTS-originated tasks in one Todoist account, which can be useful for system-level overview if direct Todoist access is ever needed by an admin.
  * Avoids requiring individual users to have or link personal Todoist accounts.
  * The primary user interface and assignment tracking (`AssignedTo_UserLink` in `FLRTS_Items`) remains within the 10NetZero-FLRTS system.
* **Plan Consideration:** A Todoist "Pro" plan for this single system account is likely sufficient and cost-effective, providing necessary API access and features like reminders. A "Business" or "Team" plan for this specific system account is not strictly necessary for the FLRTS integration's core API functionality if the Todoist UI is not the primary collaboration point for FLRTS tasks.

### 7.4. Webhook Setup for Updates from Todoist

To ensure data consistency, the system will use Todoist webhooks to receive near real-time updates for tasks managed by Todoist.

1. **Webhook Registration (via Todoist App Management Console):**
   * A "Todoist App" needs to be configured in the Todoist App Management Console ([https://developer.todoist.com/appconsole.html](https://developer.todoist.com/appconsole.html)).
   * **Webhook Callback URL:** A public HTTPS endpoint on the Flask backend will be provided to Todoist during app setup.
     * Example URL: `https://your_flask_app_domain.com/webhooks/todoist`
     * Placeholder for documentation: `___FLASK_WEBHOOK_RECEIVER_URL___`
   * **Client Secret:** Todoist will provide a `client_secret` for this app. This is critical for verifying webhook authenticity.
     * Placeholder for documentation: `___TODOIST_CLIENT_SECRET___`
   * **Watched Events:** The following event types should be subscribed to:
     * `item:completed`
     * `item:uncompleted`
     * `item:updated` (The backend will filter for relevant attribute changes like `due` or `content`).

2. **Flask Backend - Webhook Receiver Endpoint:**
   * **URL:** Matches the `___FLASK_WEBHOOK_RECEIVER_URL___` registered with Todoist.
   * **Method:** `POST`
   * **Security - Request Verification:**
     * The endpoint MUST validate the `X-Todoist-Hmac-SHA256` header sent by Todoist.
     * This HMAC is generated using the `___TODOIST_CLIENT_SECRET___` and the raw request body.
     * Requests failing signature validation must be rejected (e.g., with a `403 Forbidden`).
   * **Payload Processing:**
     * The request body will be JSON.
     * Extract `event_name`, `user_id` (identifies the Todoist account, should match the system account), and `event_data`.
     * From `event_data`, extract the Todoist `task_id` (usually `event_data.id`).
     * Query `FLRTS_Items` in Airtable for the record with the matching `TodoistTaskID`.
     * Update the Airtable record based on the event:
       * `item:completed`: Set `Status` to "Completed", `DoneAt_Timestamp`.
       * `item:uncompleted`: Set `Status` to "Open" (or previous state).
       * `item:updated`: Inspect `event_data` for changes to `due`, `content`, etc., and update corresponding Airtable fields.
   * **Response:** Return a `200 OK` to Todoist promptly upon successful receipt and basic validation. Lengthy processing should be deferred to an asynchronous task queue if necessary, though for MVP, direct processing might be acceptable.

3. **Idempotency Strategy:**
   To handle potential duplicate webhook deliveries from Todoist (e.g., due to retries):
   * **Unique Delivery ID:** Extract the `X-Todoist-Delivery-ID` header from each incoming webhook request. This ID is unique per delivery attempt.
   * **Persistent Store for IDs:** Maintain a temporary store (e.g., Redis cache, or a simple database table `ProcessedWebhookDeliveries` with fields like `DeliveryID (PK)`, `ProcessedTimestamp`) for recently processed `X-Todoist-Delivery-ID` values.
   * **Check and Record:**
     1. Upon receiving a webhook, check if its `X-Todoist-Delivery-ID` is already in the store.
     2. **If present:** Log as a duplicate, skip main processing, and return `200 OK`.
     3. **If not present:** Proceed with signature validation and main event processing logic. After successful processing, add the `X-Todoist-Delivery-ID` to the store with a timestamp. Then return `200 OK`.
   * **TTL for Stored IDs:** Implement a Time-To-Live (TTL) for stored delivery IDs (e.g., 24-72 hours) to prevent the store from growing indefinitely. This window should be longer than Todoist's likely retry period.

4. **Error Handling:**
   * Log all errors encountered during webhook processing.
   * Consider a mechanism (e.g., dead-letter queue, admin notification) for webhook events that consistently fail processing after retries or due to data issues.



## 8. Other Key Functionalities / Features (MVP)

This section details other core operational logic and system behaviors essential for the MVP.

### 8.1. Programmatic Site List Creation

* **Trigger:** Automatically initiated by the Flask backend immediately after a new `Site` record is successfully created in the `10NetZero_Main_Datastore` (typically by a `Manager` or `Admin` via the Admin Web UI or an authorized application interface).
  * Upon successful creation of the site and its lists, the Flask application will set the `Default_Lists_Created_by_App` flag (Checkbox field) on the `Sites` record to `TRUE`.
* **Default Lists Created (per new Site):** The following `FLRTS_Items` of `ItemType="List"` will be created:
  1. **Site Tools List:**
     * `Title`: "[SiteName] - Tools List"
     * `Description`: "List of tools and general equipment available or needed at [SiteName]."
     * `SystemListCategory`: "Site_Tools_List"
     * `Scope`: "site" (linked to the new Site)
     * `Visibility`: "public" (globally readable by all roles)
     * `IsSystemGenerated`: `TRUE`
     * `CreatedBy_UserLink`: "System" user.
     * `AssignedTo_UserLink`: Null/Empty.
     * Pre-populated items: None by default for MVP.
  2. **Site Master Task List:**
     * `Title`: "[SiteName] - Master Task List"
     * `Description`: "Master list of standard operational tasks and checklists for [SiteName]."
     * `SystemListCategory`: "Site_Master_Task_List"
     * `Scope`: "site"
     * `Visibility`: "public"
     * `IsSystemGenerated`: `TRUE`
     * `CreatedBy_UserLink`: "System" user.
     * `AssignedTo_UserLink`: Null/Empty.
     * Pre-populated items: None by default for MVP (can be added later as standard tasks).
  3. **Site Shopping List:**
     * `Title`: "[SiteName] - Shopping List"
     * `Description`: "List of items to be purchased for [SiteName]."
     * `SystemListCategory`: "Site_Shopping_List"
     * `Scope`: "site"
     * `Visibility`: "public"
     * `IsSystemGenerated`: `TRUE`
     * `CreatedBy_UserLink`: "System" user.
     * `AssignedTo_UserLink`: Null/Empty.
     * Pre-populated items: None by default for MVP.
* **Safety Net:** An Airtable Automation will trigger upon the creation of any new `Sites` record.
  * It will check the value of the `Default_Lists_Created_by_App` flag.
  * If this flag is `FALSE` (or not set), the automation will immediately delete the newly created `Sites` record and send a Telegram notification to a designated admin (e.g., @colinaulds), informing them of the deletion and advising them to recreate the site via the application.

### 8.2. Programmatic Employee "Onboarding" List Creation

* **Trigger:** Automatically initiated by the Flask backend immediately after a new `Personnel` record is successfully created in the `10NetZero_Main_Datastore` (typically by a `Manager` or `Admin` via the Admin Web UI or an authorized application interface).
  * Upon successful creation of the employee and their "Onboarding" list, the Flask application will set the `Default_Employee_Lists_Created` flag (Checkbox field) on the `Personnel` record to `TRUE`.
* **Default List Created (per new Employee):** One `FLRTS_Item` of `ItemType="List"`:
  * **Employee Onboarding List:**
    * `Title`: "[Employee_FullName]'s Onboarding Tasks" (e.g., "John Doe's Onboarding Tasks")
    * `Description`: "Standard onboarding tasks for new personnel."
    * `SystemListCategory`: "Employee_Onboarding"
    * `Scope`: "general"
    * `Visibility`: "public" (globally readable by all roles)
    * `IsSystemGenerated`: `TRUE`
    * `CreatedBy_UserLink`: "System" user.
    * `AssignedTo_UserLink`: The new employee.
    * Pre-populated items: One default task: `Title="Report for duty"`, `Description="Initial check-in and reporting task."`, assigned to the new employee, linked to this parent "Onboarding" list. Other standard onboarding tasks can be added to this template over time.
* **Safety Net:** An Airtable Automation will trigger upon the creation of any new `Personnel` record.
  * It will check the value of the `Default_Employee_Lists_Created` flag.
  * If this flag is `FALSE` (or not set), the automation will immediately delete the newly created `Personnel` record and send a Telegram notification to a designated admin (e.g., @colinaulds), informing them of the deletion and advising them to recreate the employee via the application.

### 8.3. Dynamic Global Master Data Views - Backend Support

The Flask backend will provide API endpoints to serve data from various master data tables in the `10NetZero_Main_Datastore`. These endpoints support the "dynamic global list views" available to users via the Telegram bot/MiniApp.

* **General Principles:**
  * All views served via these endpoints are **read-only** for the FLRTS application interface.
  * The API endpoints will enforce role-based access control for viewing data from specific tables, as defined in Section 4.1.
* **API Endpoints (Illustrative examples, actual paths TBD):**
  * `/api/sites`: Returns list of Sites. (Visible to: Everyone)
  * `/api/personnel`: Returns list of Personnel. (Visible to: Everyone)
  * `/api/partners`: Returns list of Partners. (Visible to: Managers, Admins)
  * `/api/vendors`: Returns list of Vendors. (Visible to: Everyone)
  * `/api/equipment`: Returns list of Equipment. Requires `site` or `warehouse` location filter. (Visible to: Everyone)
  * `/api/asics`: Returns list of ASICs. Requires `site` or `warehouse` location filter. (Visible to: Everyone, all fields including `PurchasePrice`).
  * `/api/operators`: Returns list of Operators. (Visible to: Everyone)
  * `/api/licenses`: Returns list of Licenses & Agreements. (Visible to: Managers, Admins. May primarily serve links to portal pages).
  * `/api/pool_accounts`: Returns list of Mining Pool Accounts. (Visible to: Managers, Admins).
* **Filtering (MVP):**
  * `/api/equipment`: Must support filtering by `SiteLocation_Link` (or a "warehouse/unassigned" status).
  * `/api/asics`: Must support filtering by `SiteLocation_Link` (or a "warehouse/unassigned" status).
  * Other endpoints may support basic filtering/searching as determined during UI development (Section 5).

### 8.4. Field Report Title Generation

The backend will programmatically generate titles for `FLRTS_Items` of `ItemType="Field Report"` upon their creation, based on the following logic:

* If the Field Report is linked to a specific `Site` (i.e., `Site_Link` is populated):
  * Format: `[SiteName]-[YYYY-MM-DD]-[UserFullName]-FR`
  * Example: "Site Alpha-2025-05-09-John Doe-FR"
* If the Field Report is not linked to a site (`Scope="general"`):
  * Format: `[UserFullName]-General-[YYYY-MM-DD]-FR`
  * Example: "John Doe-General-2025-05-09-FR"
* The `Title` field in the `FLRTS_Items` record for a new Field Report will initially be set to `null` by the LLM parsing, and the backend will populate it using this logic before saving.

### 8.5. Field Report Site Clarification Flow

* If a user submits input for a new Field Report via natural language and does not clearly specify a `Site`, or specifies an ambiguous site name:
  1. The initial LLM parsing might return a `null` or ambiguous `Site_Link`.
  2. The Flask backend will detect this lack of a clear site linkage.
  3. Before finalizing the Field Report creation, the backend (via the Telegram bot/MiniApp) will prompt the user for clarification: "Which site is this field report for? Please choose from your list of sites, or specify 'General' if it's not site-specific."
  4. The user's response will then be used to correctly set the `Site_Link` (or confirm `Scope="general"`) before the Field Report is saved and its title generated.

This section details other core operational logic and system behaviors essential for the MVP.

### 8.1. Programmatic Site List Creation

* **Trigger:** Automatically initiated by the Flask backend immediately after a new `Site` record is successfully created in the `10NetZero_Main_Datastore` (typically by a `Manager` or `Admin` via the Admin Web UI or an authorized application interface).
  * Upon successful creation of the site and its lists, the Flask application will set the `Default_Lists_Created_by_App` flag (Checkbox field) on the `Sites` record to `TRUE`.
* **Default Lists Created (per new Site):** The following `FLRTS_Items` of `ItemType="List"` will be created:
  1. **Site Tools List:**
     * `Title`: "[SiteName] - Tools List"
     * `Description`: "List of tools and general equipment available or needed at [SiteName]."
     * `SystemListCategory`: "Site_Tools_List"
     * `Scope`: "site" (linked to the new Site)
     * `Visibility`: "public" (globally readable by all roles)
     * `IsSystemGenerated`: `TRUE`
     * `CreatedBy_UserLink`: "System" user.
     * `AssignedTo_UserLink`: Null/Empty.
     * Pre-populated items: None by default for MVP.
  2. **Site Master Task List:**
     * `Title`: "[SiteName] - Master Task List"
     * `Description`: "Master list of standard operational tasks and checklists for [SiteName]."
     * `SystemListCategory`: "Site_Master_Task_List"
     * `Scope`: "site"
     * `Visibility`: "public"
     * `IsSystemGenerated`: `TRUE`
     * `CreatedBy_UserLink`: "System" user.
     * `AssignedTo_UserLink`: Null/Empty.
     * Pre-populated items: None by default for MVP (can be added later as standard tasks).
  3. **Site Shopping List:**
     * `Title`: "[SiteName] - Shopping List"
     * `Description`: "List of items to be purchased for [SiteName]."
     * `SystemListCategory`: "Site_Shopping_List"
     * `Scope`: "site"
     * `Visibility`: "public"
     * `IsSystemGenerated`: `TRUE`
     * `CreatedBy_UserLink`: "System" user.
     * `AssignedTo_UserLink`: Null/Empty.
     * Pre-populated items: None by default for MVP.
* **Safety Net:** An Airtable Automation will trigger upon the creation of any new `Sites` record.
  * It will check the value of the `Default_Lists_Created_by_App` flag.
  * If this flag is `FALSE` (or not set), the automation will immediately delete the newly created `Sites` record and send a Telegram notification to a designated admin (e.g., @colinaulds), informing them of the deletion and advising them to recreate the site via the application.

### 8.2. Programmatic Employee "Onboarding" List Creation

* **Trigger:** Automatically initiated by the Flask backend immediately after a new `Personnel` record is successfully created in the `10NetZero_Main_Datastore` (typically by a `Manager` or `Admin` via the Admin Web UI or an authorized application interface).
  * Upon successful creation of the employee and their "Onboarding" list, the Flask application will set the `Default_Employee_Lists_Created` flag (Checkbox field) on the `Personnel` record to `TRUE`.
* **Default List Created (per new Employee):** One `FLRTS_Item` of `ItemType="List"`:
  * **Employee Onboarding List:**
    * `Title`: "[Employee_FullName]'s Onboarding Tasks" (e.g., "John Doe's Onboarding Tasks")
    * `Description`: "Standard onboarding tasks for new personnel."
    * `SystemListCategory`: "Employee_Onboarding"
    * `Scope`: "general"
    * `Visibility`: "public" (globally readable by all roles)
    * `IsSystemGenerated`: `TRUE`
    * `CreatedBy_UserLink`: "System" user.
    * `AssignedTo_UserLink`: The new employee.
    * Pre-populated items: One default task: `Title="Report for duty"`, `Description="Initial check-in and reporting task."`, assigned to the new employee, linked to this parent "Onboarding" list. Other standard onboarding tasks can be added to this template over time.
* **Safety Net:** An Airtable Automation will trigger upon the creation of any new `Personnel` record.
  * It will check the value of the `Default_Employee_Lists_Created` flag.
  * If this flag is `FALSE` (or not set), the automation will immediately delete the newly created `Personnel` record and send a Telegram notification to a designated admin (e.g., @colinaulds), informing them of the deletion and advising them to recreate the employee via the application.

### 8.3. Dynamic Global Master Data Views - Backend Support

The Flask backend will provide API endpoints to serve data from various master data tables in the `10NetZero_Main_Datastore`. These endpoints support the "dynamic global list views" available to users via the Telegram bot/MiniApp.

* **General Principles:**
  * All views served via these endpoints are **read-only** for the FLRTS application interface.
  * The API endpoints will enforce role-based access control for viewing data from specific tables, as defined in Section 4.1.
* **API Endpoints (Illustrative examples, actual paths TBD):**
  * `/api/sites`: Returns list of Sites. (Visible to: Everyone)
  * `/api/personnel`: Returns list of Personnel. (Visible to: Everyone)
  * `/api/partners`: Returns list of Partners. (Visible to: Managers, Admins)
  * `/api/vendors`: Returns list of Vendors. (Visible to: Everyone)
  * `/api/equipment`: Returns list of Equipment. Requires `site` or `warehouse` location filter. (Visible to: Everyone)
  * `/api/asics`: Returns list of ASICs. Requires `site` or `warehouse` location filter. (Visible to: Everyone, all fields including `PurchasePrice`).
  * `/api/operators`: Returns list of Operators. (Visible to: Everyone)
  * `/api/licenses`: Returns list of Licenses & Agreements. (Visible to: Managers, Admins. May primarily serve links to portal pages).
  * `/api/pool_accounts`: Returns list of Mining Pool Accounts. (Visible to: Managers, Admins).
* **Filtering (MVP):**
  * `/api/equipment`: Must support filtering by `SiteLocation_Link` (or a "warehouse/unassigned" status).
  * `/api/asics`: Must support filtering by `SiteLocation_Link` (or a "warehouse/unassigned" status).
  * Other endpoints may support basic filtering/searching as determined during UI development (Section 5).

### 8.4. Field Report Title Generation

The backend will programmatically generate titles for `FLRTS_Items` of `ItemType="Field Report"` upon their creation, based on the following logic:

* If the Field Report is linked to a specific `Site` (i.e., `Site_Link` is populated):
  * Format: `[SiteName]-[YYYY-MM-DD]-[UserFullName]-FR`
  * Example: "Site Alpha-2025-05-09-John Doe-FR"
* If the Field Report is not linked to a site (`Scope="general"`):
  * Format: `[UserFullName]-General-[YYYY-MM-DD]-FR`
  * Example: "John Doe-General-2025-05-09-FR"
* The `Title` field in the `FLRTS_Items` record for a new Field Report will initially be set to `null` by the LLM parsing, and the backend will populate it using this logic before saving.

### 8.5. Field Report Site Clarification Flow

* If a user submits input for a new Field Report via natural language and does not clearly specify a `Site`, or specifies an ambiguous site name:
  1. The initial LLM parsing might return a `null` or ambiguous `Site_Link`.
  2. The Flask backend will detect this lack of a clear site linkage.
  3. Before finalizing the Field Report creation, the backend (via the Telegram bot/MiniApp) will prompt the user for clarification: "Which site is this field report for? Please choose from your list of sites, or specify 'General' if it's not site-specific."
  4. The user's response will then be used to correctly set the `Site_Link` (or confirm `Scope="general"`) before the Field Report is saved and its title generated.

## 9. Development Phases

This section outlines what order and in what scope each piece of this ecosystem will be developed and integrated with the others. 

### > Developer Note
> 
> **Goal:**  
> Design the system as a collection of **modular, self-contained components**.
> 
> **Why:**
> 
> - The lead developer is **non-technical** and relies on **LLMs to write code**.
> - Each component must fit **within a single context window** for reliable, isolated development.
> - Modularity enables **easy updates** with **minimal system-wide refactors**.
> 
> **Tradeoff:**  
> Performance is **intentionally sacrificed** for **simplicity, maintainability, and LLM compatibility**.

### Logging Philosophy

Of crucial importance is to build into this system a vigorous and intuitive logging system. Because I am not a developor, I need tons of logs all over the place in order to quickly troubleshoot an issue. I also need logs that are written as if a non-technical ‘normal’ person (layman) is going to have to read and understand them. 

I highly desirable feature if it would not be too difficult would be the ability to call in chatGPT right from inside my terminal where a shell alias makes a call to chatGPT API with a prompt like: you are a coding and command line expert who helps people understand outputs they quite get - [pasted in previous 10 commands and their outputs]. Explain the last few outputs and what the user might consider doing next.”

### Phases

1. 

This list includes features mentioned in the user's original "10NetZero Integrated Platform Des

## 10. Future Features
## Potential Future Features to Consider (from Project Documentation & Discussion)

This list includes features mentioned in the user's original "10NetZero Integrated Platform Design" document (PDF Pg 14) and other ideas that have come up, which could be considered for V2+ or further enhancements beyond the initial MVP.

* **Reporting & Analytics:**
  * Report to PDF export (PDF Pg 14)
  * API usage analytics (PDF Pg 14)
  * Enhanced analytics dashboard for FLRTS items and user activity.
  * **ASIC Performance & Viability Analytics:** Logging and analysis of detailed time-series data from ASICs (potentially via API from farm management software) for operational insights, purchasing decisions, and long-term model viability studies. (Related to a potential `ASIC_Performance_Log` table).
* User Roles & Permissions:
  * **"Partner" Role:** Introduce a new user role designed for external partners, providing selective, granular read-only access to specific data relevant to their engagement (e.g., specific site information, shared reports, or relevant partner agreements). * 
  * **Advanced Granular Permissions Model:** Post-MVP, evolve the permission system to support more detailed, possibly attribute-based or Access Control List (ACL)-style permissions for both FLRTS items and master data. This would allow for finer-grained control beyond the MVP's broader role definitions (incorporating the more complex permission considerations initially discussed). 
  * Custom User-Created Personal Lists:** Allow users to create, manage, and own their private `FLRTS_Items` of `ItemType="List"` for personal tasks, notes, or reminders, with options for keeping them private or sharing them with specific individuals or teams.
* **Extended Integrations & Input Methods:**
  * Webhook alerts to third-party systems (PDF Pg 14)
  * Auto-create FLRTS items from emails (via Gmail API, using GPT for conversion - PDF Pg 14)
  * Google Workspace Integration (Calendar, Drive for more than just SiteGPT docs - PDF Pg 22, 25)
  * Slack or other messaging platform integration.
  * **Automated List Updates from Receipts:** Monitor receipt inputs (e.g., into Airtable or via an expense system) and automatically update relevant FLRTS lists (e.g., shopping lists, project expenses).

* **Enhanced NLP & AI Capabilities:**
  * **LLM Middleware for Bot Input** (more advanced NLP to structured commands, intent parsing - PDF Pg 14) 
  * **Confidence scores** from the General LLM for `ItemType` classification to trigger clarification flows. 
  * Deeper SiteGPT integration for FLRTS item enrichment (e.g., SiteGPT analyzes a Field Report and suggests related documents or insights from its knowledge base). 
  * AI-Powered Assistance via vector DB (as mentioned in PDF Pg 24, likely related to SiteGPT or a similar RAG setup for broader data). 
  * **LLM Validation for User Inputs:** (e.g., Forcing an "articulable reason" for due date changes by having the LLM evaluate the provided comment). 
  * **Advanced RAG for Technical Documents:** (e.g., Linking equipment/ASIC manuals stored as PDFs to chunked versions for SiteGPT/RAG LLM querying). 
  * **NLP for Querying Licenses & Agreements:** Enable users to ask natural language questions against the content of documents stored in the `Licenses & Agreements` table. 
  * **NLP for Dynamic Simplified Views:** Use NLP to determine the "most important data" to show in simplified views of dynamic lists based on user query or context.

* **User Interface & Experience (UI/UX) Enhancements:**
  * Interactive FLRTS Menus in Telegram/MiniApp (inline action buttons for edit, archive, complete - PDF Pg 14)
  * User Admin Dashboard (limited access UI for non-admin users to manage their settings/preferences - PDF Pg 14)
  * Advanced MiniApp form interactions (V2): Focused field editors like site selectors, user pickers, mini-calendars as an alternative to pure NLP correction for complex edits.
  * Native Mobile App or Progressive Web App (PWA) for a richer mobile experience, potentially with offline capabilities.
  * Multi-language support for the bot and MiniApp.

* **Advanced FLRTS Functionality:**
  * More sophisticated "subtask" management and visualization.
  * Advanced recurring task options beyond what Todoist might offer through its standard parsing, if needed.
  * Offline mode/caching for the MiniApp.
  * **Custom Personal Lists:** Allow users to create their own private lists (viewable by self, admins, and "owners") for personal reminders, tasks, etc., within the FLRTS system.
  * **Task Reassignment with Notes:** Enable users to reassign tasks to other personnel, including an optional note explaining the reassignment.
  * **Due Date Changes with Mandatory Comment:** Require users to provide a mandatory, articulable reason (validated by LLM) when changing task due dates.

* **Operational Enhancements:**
  * Improved API rate-limit handling (PDF Pg 25).
  * More comprehensive automated testing (unit, integration, E2E - PDF Pg 25).
  * Enhanced bot uptime/status monitoring (PDF Pg 25).
  * Expanded audit logs for compliance (PDF Pg 25).




# 